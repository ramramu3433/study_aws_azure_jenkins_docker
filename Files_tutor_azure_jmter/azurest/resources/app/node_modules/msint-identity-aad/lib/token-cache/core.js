/*!---------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *----------------------------------------------------------*/
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var _ = require("underscore");
function find(cache, query) {
    return _.where(cache, query);
}
exports.find = find;
function add(cache, entries) {
    // First remove existing entries with the same key
    _.each(cache, function (cachedEntry, index) {
        _.each(entries, function (entry) {
            if (cachedEntry._authority === entry._authority &&
                cachedEntry._clientId === entry._clientId &&
                cachedEntry.userId === entry.userId &&
                cachedEntry.resource === entry.resource) {
                cache[index] = null;
            }
        });
    });
    cache = _.compact(cache);
    // Now add the new or updated entries
    cache.push.apply(cache, entries);
    return cache;
}
exports.add = add;
function remove(cache, entries) {
    return _.filter(cache, function (entry) { return !_.findWhere(entries, entry); });
}
exports.remove = remove;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy90b2tlbi1jYWNoZS9jb3JlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs4REFFOEQ7QUFFOUQsWUFBWSxDQUFDOztBQUViLDhCQUFnQztBQUdoQyxjQUFxQixLQUE2QixFQUFFLEtBQTJCO0lBQzNFLE1BQU0sQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztBQUNqQyxDQUFDO0FBRkQsb0JBRUM7QUFFRCxhQUFvQixLQUE2QixFQUFFLE9BQStCO0lBQzlFLGtEQUFrRDtJQUNsRCxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxVQUFDLFdBQVcsRUFBRSxLQUFLO1FBQzdCLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFVBQUEsS0FBSztZQUNqQixFQUFFLENBQUMsQ0FBQyxXQUFXLENBQUMsVUFBVSxLQUFLLEtBQUssQ0FBQyxVQUFVO2dCQUMzQyxXQUFXLENBQUMsU0FBUyxLQUFLLEtBQUssQ0FBQyxTQUFTO2dCQUN6QyxXQUFXLENBQUMsTUFBTSxLQUFLLEtBQUssQ0FBQyxNQUFNO2dCQUNuQyxXQUFXLENBQUMsUUFBUSxLQUFLLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO2dCQUMxQyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsSUFBSSxDQUFDO1lBQ3hCLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBQ0gsS0FBSyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7SUFFekIscUNBQXFDO0lBQ3JDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztJQUVqQyxNQUFNLENBQUMsS0FBSyxDQUFDO0FBQ2pCLENBQUM7QUFsQkQsa0JBa0JDO0FBRUQsZ0JBQXVCLEtBQTZCLEVBQUUsT0FBK0I7SUFDakYsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLFVBQUEsS0FBSyxJQUFJLE9BQUEsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsRUFBNUIsQ0FBNEIsQ0FBQyxDQUFDO0FBQ2xFLENBQUM7QUFGRCx3QkFFQyIsImZpbGUiOiJ0b2tlbi1jYWNoZS9jb3JlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqIENvcHlyaWdodCAoQykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG5cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5pbXBvcnQgKiBhcyBfIGZyb20gXCJ1bmRlcnNjb3JlXCI7XHJcbmltcG9ydCAqIGFzIGFkYWwgZnJvbSBcImFkYWwtbm9kZVwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZpbmQoY2FjaGU6IGFkYWwuVG9rZW5DYWNoZUVudHJ5W10sIHF1ZXJ5OiBhZGFsLlRva2VuQ2FjaGVRdWVyeSkge1xyXG4gICAgcmV0dXJuIF8ud2hlcmUoY2FjaGUsIHF1ZXJ5KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFkZChjYWNoZTogYWRhbC5Ub2tlbkNhY2hlRW50cnlbXSwgZW50cmllczogYWRhbC5Ub2tlbkNhY2hlRW50cnlbXSkge1xyXG4gICAgLy8gRmlyc3QgcmVtb3ZlIGV4aXN0aW5nIGVudHJpZXMgd2l0aCB0aGUgc2FtZSBrZXlcclxuICAgIF8uZWFjaChjYWNoZSwgKGNhY2hlZEVudHJ5LCBpbmRleCkgPT4ge1xyXG4gICAgICAgIF8uZWFjaChlbnRyaWVzLCBlbnRyeSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjYWNoZWRFbnRyeS5fYXV0aG9yaXR5ID09PSBlbnRyeS5fYXV0aG9yaXR5ICYmXHJcbiAgICAgICAgICAgICAgICBjYWNoZWRFbnRyeS5fY2xpZW50SWQgPT09IGVudHJ5Ll9jbGllbnRJZCAmJlxyXG4gICAgICAgICAgICAgICAgY2FjaGVkRW50cnkudXNlcklkID09PSBlbnRyeS51c2VySWQgJiZcclxuICAgICAgICAgICAgICAgIGNhY2hlZEVudHJ5LnJlc291cmNlID09PSBlbnRyeS5yZXNvdXJjZSkge1xyXG4gICAgICAgICAgICAgICAgY2FjaGVbaW5kZXhdID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICBjYWNoZSA9IF8uY29tcGFjdChjYWNoZSk7XHJcblxyXG4gICAgLy8gTm93IGFkZCB0aGUgbmV3IG9yIHVwZGF0ZWQgZW50cmllc1xyXG4gICAgY2FjaGUucHVzaC5hcHBseShjYWNoZSwgZW50cmllcyk7XHJcblxyXG4gICAgcmV0dXJuIGNhY2hlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlKGNhY2hlOiBhZGFsLlRva2VuQ2FjaGVFbnRyeVtdLCBlbnRyaWVzOiBhZGFsLlRva2VuQ2FjaGVFbnRyeVtdKSB7XHJcbiAgICByZXR1cm4gXy5maWx0ZXIoY2FjaGUsIGVudHJ5ID0+ICFfLmZpbmRXaGVyZShlbnRyaWVzLCBlbnRyeSkpO1xyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
