# Select Certificate (MS Internal)

The msint-selectcert module shows native UI that allows a user to select from a list of client certificates, typically used in response to a https CONNECT where the server is requesting a client certificate.

## Pre-requisites

Because this is a native module, usage of this module depends on certain build tools being present on the target machine.

### OSX
Install [Xcode](https://developer.apple.com/xcode/downloads/) to get the native build tools.

### Windows
Install [Visual Studio 2015](\\cpvsbuild\drops\dev14\d14rel\layouts\x86ret\23107.10\enu\vs\enterprise\dvd\vs_enterprise.exe) to get the native build tools. Ensure during installation that all the C++ optional components are selected (none of them are installed by default).

Install [Python 2.7.3]((https://www.python.org/download/releases/2.7.3/#download). Do NOT get a later version.

### NPM Configuration
As an MS internal module, you must configure npm to use the internal NPM registry:

```
npm set //ms-npm/:username=xxx
npm set //ms-npm/:email=xxx@microsoft.com
npm set //ms-npm/:_password=xxx
```

(You can replace "xxx" with whatever value you want, or just leave it).

## Installation

Install this module into your application using npm:

```
npm install msint-selectcert --registry=http://ms-npm --save
```

The act of installing the module will compile the source code. For this to work successfully on Windows, run this command from inside a Developer Command Prompt for VS2015.

## Usage

Require the selectCertificate method from the module in your code:

```
import { selectCertificate } from "msint-selectcert";
```

Given an array of Base-64 encoded X.509 certificates that include begin/end headers:

```
let selectedIndex = selectCertificate(certificates);
```

This synchronously prompts the user using the native UI.
If the user chooses a certificate, the returned index identifies which certificate in the array was selected.
If the user canceled the operation, or some other error occurred, -1 is returned.